# 1. 数据库基础

## 1.1. 数据库 Database

&emsp;&emsp;保存有组织的数据的容器（通常是一个文件或一组文件),通过数据库管理系统**DBMS**进行创建和操作。

> [!NOTE]
> 平时使用的 Mysql Oracle Sqlite 等均属于数据库管理系统**DBMS**

## 1.2. 表 table

&emsp;&emsp;某种特定类型数据的结构化清单,储在表中的数据是同一种类型的数据或清单

- 表名:
  - 作为表的唯一标识，实际上是数据库名和表名等的组合。
  - 有的数据库还使用数据库拥有者的名字作为唯一名的一部分。也就是说，虽然在相同数据库中不能两次使用相同的表名，但在不同的数据库中完全可以使用相同的表名

## 1.3. 模式 scheme

&emsp;&emsp;模式也称逻辑模式，是关于数据库和表的布局及特性的信息的描述(数据库信息,表的信息以及表之间的关系)，是所有用户的公共数据视图。

- 特征
  - 一个数据库只有一个模式;
  - 是数据库数据在逻辑级上的视图;
  - 数据库模式以某一种数据模型为基础;
  - 定义模式时不仅要定义数据的逻辑结构(如数据记录由哪些数据项构成，数据项的名字、类型、取值范围等)，而且要定义与数据关的安全性、完整性要求，定义这些数据之间的联系

### 1.3.1. 外模式 External Schema

&emsp;&emsp;外模式也称子模式(Subschema)或用户模式，是数据库用户(包括应用程序员和最终用户)能够看见和使用的局部数据的逻辑结构和特征的描述，是数据库用户的数据视图，是与某一应用有关的数据的逻辑表示。

- 特征
  - 一个数据库可以有多个外模式;
  - 外模式就是用户视图;
  - 外模式是保证数据安全性的一个有力措施

### 1.3.2. 内模式 Internal Schema

&emsp;&emsp;内模式也称存储模式(Storage Schema)，它是数据物理结构和存储方式的描述，是数据在数据库内部的表示方式(例如，记录的存储方式是顺序存储、按照 B 树结构存储还是按 hash 方法存储;索引按照什么方式组织;数据是否压缩存储，是否加密;数据的存储记录结构有何规定)

- 特征
  - 一个数据库只有一个内模式;
  - 一个表可能由多个文件组成，如：数据文件、索引文件。
  - 它是数据库管理系统(DBMS)对数据库中数据进行有效组织和管理的方法

## 1.4. 列 column

&emsp;&emsp;表中的一个字段。所有表都是由一个或多个列组成的,数据库中每个列都有相应的数据类型。数据类型（ datatype ）定义了列可以存储哪些数据种类。

## 1.5. 行 row

表中的一个记录

## 1.6. 主键 primary Key

表中每一行都应该有一列（或几列）可以唯一标识自己，一列（或一组列），其值能够唯一标识表中每一行。

> [!NOTE]
> 主键具有唯一性且不为空

- 主键定义<br>
  &emsp;&emsp;虽然并不总是需要主键，但多数数据库设计者都会保证他们创建的每个表具有一个主键，以便于以后的数据操作和管理。
  1. 任意两行都不具有相同的主键值；
  2. 每一行都必须具有一个主键值（主键列不允许 NULL 值）；
  3. 主键列中的值不允许修改或更新；
  4. 主键值不能重用（如果某行从表中删除，它的主键不能赋给以后的新行）

## 1.7. 外键[foreign key]

## 1.8. 触发器

&emsp;&emsp;触发器是一种特殊的存储过程，主要是通过事件来触发而被执行的。它可以强化约束，来维护数据的完整性和一致性，可以跟踪数据库内的操作从而不允许未经许可的更新和变化。可以联级运算。如，某表上的触发器上包含对另一个表的数据操作，而该操作又会导致该表触发器被触发。

- 触发器触发条件

  - 触发时间：有 before,after
  - 触发事件：有 insert,update,delete 三种。总共 6 种
  - 触发类型：有行触发、语句触发

- 创建触发器
  ```sql
  CREATE TRIGGER trigger_name
  trigger_time
  trigger_event ON tbl_name
  FOR EACH ROW
  trigger_stmt(单条sql语句)
  或
  BEGIN
  [statement_list]
  END
  ## 说明 ##
  1.	trigger_name：标识触发器名称，用户自行指定；
  2.	trigger_time：标识触发时机，取值为 BEFORE 或 AFTER；
  3.	trigger_event：标识触发事件，取值为 INSERT、UPDATE 或 DELETE；
  4.	tbl_name：标识建立触发器的表名，即在哪张表上建立触发器；
  5.	trigger_stmt：触发器程序体，可以是一句SQL语句，或者用 BEGIN 和 END 包含的多条语句
  ```

> [!NOTE]
> 同一个表最多只能创建 6 个触发器

## 1.9. 视图

- **概念介绍**<br>
  &emsp;&emsp;`视图`是从一个或多个表（或视图）导出的表。视图与表（有时为与视图区别，也称表为基本表——Base Table）不同，视图是一个虚表，即视图所对应的数据不进行实际存储，数据库中只存储视图的定义，在对视图的数据进行操作时，系统根据视图的定义去操作与视图相关联的基本表。<br>
  &emsp;&emsp;`视图`是一种虚拟的表，具有和物理表相同的功能。可以对视图进行增，改，查，操作，试图通常是有一个表或者多个表的行或列的子集。对视图的修改不影响基本表。它使得我们获取数据更容易，相比多表查询<br>

## 1.10. 游标

## 1.11. 完整性约束

## 1.12. 三大范式

&emsp;&emsp;`范式`是指符合某种级别的关系模式的集合,关系数据库遵循三大范式。

- 第一范式(原子性):选项中所有属性的值都是单个值,那么关系模式是第一范式，有主关键字,主键不为空,字段不可以再分<br>
&emsp;&emsp;如地址信息中包含省份,城市可以进一步拆分

- 第二范式(多对多):满足第一范式条件的同时,关系中每一个非主属性不部分依赖主键,则称为第二范式，第二范式主要是满足第一范式的前提下消除部分依赖<br>
&emsp;&emsp;如订单商品表中的订单价格只与订单有关而与商品没有关系,可以拆分成不同表

- 第三范式(一对多):满足第二范式的前提下,消除传递依赖, 要确保数据表中的每一列数据都和主键直接相关，而不能间接相关<br>\
&emsp;&emsp;如订单商品表中商品名称直接依赖的是商品编号而不是强依赖订单编号.

## 1.13. 事务处理

### ACID 事物的特性
- 原子性
- 一致性
- 隔离性
- 持久性

### 事物隔离级别

- Read UnCommit
- Read Commit
- Repeat Commit
- Serial

## 1.14. 存储过程
