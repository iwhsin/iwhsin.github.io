# 1. Java语言环境
> 熟悉了 Java 语言的一些特性，那么 Java 语言这些特性的实现当然离不开它的运行环境（JVM虚拟机）。

## 1.1. JVM虚拟机
### 1.1.1. 介绍和用处
&emsp;&emsp;`JVM（Java Virtual Machine）`虚拟机是一个应用程序，提供了运行Java程序所需的运行时环境。如果某个硬件和操作系统平台没有相应的JVM，就不能运行Java程序。<br>
&emsp;&emsp;执行`java <arguments> <program name>` 命令会在操作系统的一个进程中启动JVM。

- `JVM`虚拟机提供了什么用处？
    1. 提供一个容器，让应用程序代码运行在其中；
    2. 较`C/C++`，提供了一个安全的执行环境；
    3. 帮助代开发者管理内存；
    4. 提供一个跨平台的执行环境;
    4. JVM使用运行时信息进行自我管理。

### 1.1.2. 运行在`JVM`中的语言

&emsp;&emsp;理论上，`JVM`虚拟机能运行任何有效的类文件，除了 Java 程序能运行在`JVM`虚拟机中，像`Groovy`、`Scala`、`Kotlin`、`Clojure`等也都可以运行在`JVM`虚拟机中(参考[运行在JVM中的语言][2])。

- 其它语言在`JVM`中的运行方式，主要通过两种方式运行。
    1. 第一种，提供用于生成类文件的源码编译器（类似于javac），以类似Java代码的方式在JVM中运行（Scala等语言采用的是这种方式）。
    2. 第二种可以使用Java实现解释器和运行时，然后解释该语言使用的源码格式。JRuby等语言采用的就是这种方式。

## 1.2. Java程序生命周期

&emsp;&emsp;![类加载与编译][1]

&emsp;&emsp;Java 程序的生命周期首先从Java 源码开始的，通过`javac`编译后转换为字节码文件（.class），再经过`JVM`虚拟机中的解释器将字节码解释为机器码运行。

### 1.2.1. 字节码是什么？
&emsp;&emsp;Java 中的 **字节码** 是以`.class`结尾的特殊的类文件。是处于 **源码** 和 **机器码** 之间的`中间表现形式`。通过`javac`编译器将 **源码** 编译为 **字节码**，再提供给`JVM`虚拟机进行高效解释执行。<br>
&emsp;&emsp;**字节码** 是与设备无关的，不管哪种设备，生成的字节码都是一样的，其中也包括设备使用的字节顺序。

### 1.2.2. 操作码（指令码）是什么？
&emsp;&emsp;指令码（操作码）只占一个字节（有些操作还可以有参数，即跟随其后的字节流），所以只有256个可用的指令。实际上，有些指令用不到，大概只会使用200个，而且其中还有一些是最新版javac不支持的。

### 1.2.3. `javac`是编译器吗？
&emsp;&emsp;**编译器** 一般指的是将源码进行编译生成机器码，而`javac`并不算完整的编译器，只是将 java 源码编译为中间文件 `字节码`，再由`JVM`虚拟机中的解释器（JIT）进一步编译成机器码进行解释执行。

- 在 Java 语言中将编译分为两部分，分别为`前端编译` 和 `后端编译`。
    1. **前端编译**：将源码编译为`字节码`文件。`javac`执行的就是这一步操作，又称为 `源码编译`。
    2. **后端编译**：将 `字节码` 进一步编译成机器码，进行解释执行。`JVM`虚拟机中的解释器（JIT）就是执行的这一步操作。

### 1.2.4. Java语言是解释性语言吗？
- 什么是解释性语言？<br>
&emsp;&emsp;我们都知道计算机只能理解机器语言，而高级语言编写的程序若要被计算机进行执行，必须要先将高级语言翻译为机器语言，再由计算机进行执行，而翻译的形式一般有两种：`解释` 和 `编译`。<br>
&emsp;&emsp;在 Java 语言中，`JVM`虚拟机基本上算是解释器（JIT编译大大提升了性能）。而`JVM`解释执行的是`字节码`，需要先用`javac`将源码编译为`字节码`。因此，可以看出 Java 并不完全算是解释性语言。<br>
&emsp;&emsp;常见的解释性语言有`python`、`javascript`等，在程序运行时，边解释边执行，执行效率较低，而且解释性语言的运行结果可能会受到环境的影响（比如`python2`和`python3`）。



<!-- 资源链接 -->
[1]: ../../../assets/images/java-class-life-cycle.png
[2]: docs/basic/java-language-feature/introduction/language-run-in-jvm.md '运行在JVM中的语言'