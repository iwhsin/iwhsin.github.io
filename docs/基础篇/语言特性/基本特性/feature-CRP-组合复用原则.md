# 组合复用原则(CRP)
> 面向对象编程语言中通过使用`继承`、`组合`、`代理`等方式实现了代码的复用，通过代码复用，大大提高了开发效率。

## 继承VS组合

- **什么是继承？**<br>
&emsp;&emsp;继承（Inheritance）是一种联结类与类的层次模型。是指一个类(子类、子接口)继承另一个类（父类、父接口），拥有被继承类的相关属性和功能。<br>
&emsp;&emsp;继承是`is-A`的概念。

- **什么是组合？**<br>
&emsp;&emsp;组合(Composition)体现的是整体与部分、拥有的关系，即`has-a`的关系。

- **组合和继承的联系和区别**
    - `继承`结构中，父类的内部细节对于子类是可见的。所以我们通常也可以说通过继承的代码复用是一种`白盒式代码复用`。（如果基类的实现发生改变，那么派生类的实现也将随之改变。这样就导致了子类行为的不可预知性）
    - `组合`是通过对现有的对象进行拼装（组合）产生新的、更复杂的功能。因为在对象之间，各自的内部细节是不可见的，所以我们也说这种方式的代码复用是`黑盒式代码复用`。（因为组合中一般都定义一个类型，所以在编译期根本不知道具体会调用哪个实现类的方法）
    - `继承`，在写代码的时候就要指名具体继承哪个类，所以，在`编译期`就确定了关系。（从基类继承来的实现是无法在运行期动态改变的，因此降低了应用的灵活性。）
    - `组合`，在写代码的时候可以采用面向接口编程。所以，类的组合关系一般在`运行期`确定。

- **组合优于继承**
| 特性 | 组合 | 继承 |
| :- | :- | :- |
| 封装性   | 优点：不破坏封装，整体类与局部类之间松耦合，彼此相对独立                           | 破坏封装，子类与父类之间紧密耦合，子类依赖于父类的实现，子类缺乏独立性 |
| 扩展性   | 优点：具有较好的可扩展性，整体类可以对局部类进行包装，封装局部类的接口，提供新的接口 | 支持扩展，但是往往以增加系统结构的复杂度为代价，并且子类不能改变父类的接口 |
| 动态性   | 优点：支持动态组合。在运行时，整体对象可以选择不同类型的局部对象                   | 不支持动态继承。在运行时，子类无法选择不同的父类 |
| 继承性   | 缺点：整体类不能自动获得和局部类同样的接口                                       | 子类能自动继承父类的接口 |
| 对象创建 | 缺点：创建整体类的对象时，需要创建所有局部类的对象                                | 优点：创建子类的对象时，无须创建父类的对象 |

- **如何选择（[inheritance-vs-composition-in-java][1]）**<br>
&emsp;&emsp;根据`合成复用原则`，在实际使用过程中`多用组合，少用继承`也就是说`组合优于继承`，因为组合更安全，更简单，更灵活，更高效。

<!-- 资源链接 -->
[1]: https://www.programcreek.com/2014/05/inheritance-vs-composition-in-java/
