# 数据库专题

## 索引

索引其实是一种数据结构，能够帮助我们快速的检索数据库中的数据。


### 索引的数据结构

- Hash索引
    - 哈希表是一种以 key-value 存储数据的结构，所以多个数据在存储关系上是完全没有任何顺序关系的，所以，对于区间查询是无法直接通过索引查询的，就需要全表扫描
    - 哈希索引只适用于等值查询的场景
- B+ Tree
    - InnoDB 默认B+Tree
    - B+ Tree 是一种多路平衡查询树，所以他的节点是天然有序的（左子节点小于父节点、父节点小于右子节点），所以对于范围查询的时候不需要做全表扫描

?> <i class='icon-brand-tripadvisor'></i>
哈希索引适合等值查询，但是不无法进行范围查询 
哈希索引没办法利用索引完成排序 哈希索引不支持多列联合索引的最左匹配规则 如
果有大量重复键值得情况下，哈希索引的效率会很低，因为存在哈希碰撞问题

### 聚簇索引、覆盖索引
- 聚集索引和非聚集索引的根本区别是表中记录的物理顺序和索引的排列顺序是否一致
- B+ Tree 的叶子节点都可以存哪些东西吗
    - InnoDB 的 B+ Tree 可能存储的是整行数据，也有可能是主键的值
        - 聚簇索引: 主键索引(一级索引) ==> 存储整行值 ==> 不需要回表即可查出所有数据
        - 非聚簇索引: 存储主键的值(二级索引) ==> 回表查询主键对应行的数据
            - 覆盖索引: 满足覆盖索引条件的查询也不需要回表即可查询出完整数据
### 索引下推、查询优化
- 联合索引 ==> 最左匹配原则
- 索引下推 ==> 减少回表 ==> 5.6引入

### 索引失效

- 查询优化器(执行计划/路径)
    - 根据搜索条件，找出所有可能使用的索引 
    - 计算全表扫描的代价 
    - 计算使用不同索引执行查询的代价 
    - 对比各种执行方案的代价，找出成本最低的那一个

### explain 查询索引执行计划
[explain](https://www.cnblogs.com/tufujie/p/9413852.html)
- id、select_type、table、type、possible_keys、key、key_len、ref、rows、Extra
    - type
    - key
    - key_len
    - rows
    - extra